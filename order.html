<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طلب خدمة – سهل للخدمات</title>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        body {
            margin: 0;
            font-family: 'Cairo', sans-serif;
            background-color: #f7f7f7;
        }

        header {
            background-color: #27415d;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        header img {
            height: 60px;
            border-radius: 50%;
        }

        .menu-btn {
            font-size: 30px;
            cursor: pointer;
            color: white;
        }

        .sidebar {
            height: 100%;
            width: 0;
            position: fixed;
            top: 0;
            right: 0;
            background-color: #27415d;
            overflow-x: hidden;
            transition: 0.4s;
            padding-top: 60px;
            z-index: 1000;
        }

        .sidebar a {
            padding: 15px 25px;
            text-decoration: none;
            font-size: 20px;
            font-weight: 600;
            color: white;
            display: block;
        }

        .sidebar a:hover {
            background-color: #e17c1b;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            left: 20px;
            font-size: 30px;
            cursor: pointer;
            color: white;
        }

        h1 {
            text-align: center;
            color: #27415d;
            margin-top: 25px;
        }

        .counter {
            text-align: center;
            color: #e17c1b;
            font-size: 20px;
            margin-top: -10px;
            margin-bottom: 20px;
        }

        .form-box {
            background: white;
            margin: 20px;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        label {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            margin-bottom: 18px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
            font-family: 'Cairo';
        }

        textarea {
            height: 140px;
            resize: none;
        }

        button {
            width: 100%;
            padding: 14px;
            background-color: #e17c1b;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
        }

        button:hover {
            background-color: #c96b17;
        }

        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .checkbox-row input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }

        .success-box {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            display: none;
            font-size: 18px;
            text-align: center;
        }
    </style>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { 
            getFirestore, collection, addDoc, getDocs 
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadOrdersCount() {
            try {
                const querySnapshot = await getDocs(collection(db, "orders"));
                document.getElementById("ordersCount").textContent =
                    "عدد الطلبات المنجزة: " + querySnapshot.size;
            } catch (e) {
                document.getElementById("ordersCount").textContent =
                    "عدد الطلبات المنجزة: -";
            }
        }

        window.loadOrdersCount = loadOrdersCount;

        async function saveOrderToFirebase(orderData) {
            try {
                await addDoc(collection(db, "orders"), orderData);
                await loadOrdersCount();
            } catch (e) {
                console.error("Error adding document: ", e);
            }
        }

        window.saveOrderToFirebase = saveOrderToFirebase;
    </script>

    <script>
        function openSidebar() {
            document.getElementById("sidebar").style.width = "250px";
        }

        function closeSidebar() {
            document.getElementById("sidebar").style.width = "0";
        }

        const servicesByCategory = {
            "خدمات التصميم": [
                "تصميم سيرة ذاتية ( الغة  العربية فقط )",
                "تصميم سيرة ذاتية ( الغة الانجليزية فقط )",
                "تصميم سيرة ذاتية ( الغة العربي - الانجليزي  )",
                "تصميم منشور ( العدد 1)",
                "تصميم بوست (العدد 1)",
                "تصميم فيديو ( المدة 1د)",
                "تصميم فيديو ( المدة 2د)",
                "تصميم فيديو ( المدة 3د)",
                "تصميم فيديو ( المدة 4د)",
                "تصميم فيديو ( المدة5د)",
                "تصميم قائمة طعام ( عدد الصفحات 1 -5 صفحات)",
                "تصميم شهادات شكر ( عدد الشهادات من 1-5 )",
                "تصميم شهادات شكر ( عدد الشهادات من 1-10 )",
                "تصميم شهادات شكر ( عدد الشهادات من 1-20)"
            ],
            "التعليم والمهام": [
                "دورات تدريبية ( دروب )",
                "دورات تدريبية ( إثرائي  )",
                "دورات تدريبية (  إبعاد  )",
                "دورات تدريبية ( إدراك  )",
                "دورات تدريبية ( معهد الأدارة )",
                "دورات تدريبية (ذكاء الاصطناعي سماي  )",
                "دورات تدريبية ( المعهد الوطني التربوي  )",
                "بحوث (  صفحتين)",
                "بحوث (  5صفحات )",
                "بحوث ( 8صفحات )",
                "بحوث ( 10صفحات )",
                "بحوث ( 15صفحات )",
                "أوراق عمل ( ورقة  )",
                "أوراق عمل ( ورقتين   )",
                "أوراق عمل ( أورق 3 )",
                "أوراق عمل ( أورق4 )",
                "أوراق عمل ( أورق 5 )",
                "أوراق عمل ( أورق 8 )",
                "أوراق عمل ( أورق 10 )",
                "مهام أدائية",
                "ملف إنجاز ( صفحات 5)",
                "ملف إنجاز ( صفحات8)",
                "ملف إنجاز ( صفحات 10)",
                "ملف إنجاز ( صفحات 15)",
                "ملف إنجاز ( صفحات20)",
                "مشروع تخرج( صفحات 5)",
                "مشروع تخرج( صفحات 10)",
                "مشروع تخرج( صفحات 15)",
                "مشروع تخرج( صفحات 20)",
                "عروض تقديمية( صفحات 5)",
                "عروض تقديمية( صفحات 10)",
                "عروض تقديمية( صفحات 15)"
            ],
            "الخدمات الإلكترونية": [
                "ساعات تطوعية (40س)",
                "ساعات تطوعية (45س)",
                "ساعات تطوعية (50س)",
                "ساعات تطوعية (55س)",
                "ساعات تطوعية (60س)",
                "ساعات تطوعية (70س)",
                "ساعات تطوعية (80س)",
                "ساعات تطوعية (90س)",
                "ساعات تطوعية (100س)",
                "ساعات تطوعية (120س)",
                "ساعات تطوعية (150س)",
                "ساعات تطوعية (200س)",
                "إنشاء متجر سلة",
                "إصدار وثيقة العمل الحر ( دون شهادات )",
                "إصدار وثيقة العمل الحر ( إضافة شهادات )",
                "إصدار رخصة فال العقارية"
            ]
        };

        function updateDetailsOptions() {
            const category = document.getElementById("category").value;
            const detailsSelect = document.getElementById("serviceDetails");
            detailsSelect.innerHTML = '<option value="">اختر تفاصيل الخدمة</option>';

            if (servicesByCategory[category]) {
                servicesByCategory[category].forEach(item => {
                    const opt = document.createElement("option");
                    opt.value = item;
                    opt.textContent = item;
                    detailsSelect.appendChild(opt);
                });
            }
        }

        async function sendOrder() {
            let name = document.getElementById("name").value.trim();
            let phone = document.getElementById("phone").value.trim();
            let category = document.getElementById("category").value;
            let serviceDetails = document.getElementById("serviceDetails").value;
            let note = document.getElementById("note").value.trim();
            let know = document.getElementById("know").value;
            let discount = document.getElementById("discount").value.trim();

            let agree1 = document.getElementById("agree1").checked;
            let agree2 = document.getElementById("agree2").checked;

            if (!name || !phone || !category || !serviceDetails) {
                alert("الرجاء تعبئة جميع الحقول المطلوبة");
                return;
            }

            if (phone.length !== 10 || !phone.startsWith("05")) {
                alert("الرجاء إدخال رقم جوال صحيح مكون من 10 أرقام ويبدأ بـ 05");
                return;
            }

            if (!agree1 || !agree2) {
                alert("يجب الموافقة على الشروط قبل إرسال الطلب");
                return;
            }

            const orderData = {
                name,
                phone,
                category,
                serviceDetails,
                note: note || "",
                know,
                discount: discount || "",
                status: "جديد",
                createdAt: new Date().toISOString()
            };

            if (window.saveOrderToFirebase) {
                await window.saveOrderToFirebase(orderData);
            }

            document.getElementById("successBox").style.display = "block";

            document.getElementById("name").value = "";
            document.getElementById("phone").value = "";
            document.getElementById("category").value = "";
            document.getElementById("serviceDetails").innerHTML = '<option value="">اختر تفاصيل الخدمة</option>';
            document.getElementById("note").value = "";
            document.getElementById("discount").value = "";
            document.getElementById("agree1").checked = false;
            document.getElementById("agree2").checked = false;
        }

        window.onload = function () {
            if (window.loadOrdersCount) {
                window.loadOrdersCount();
            }
        };
    </script>

</head>
<body>

    <div id="sidebar" class="sidebar">
        <span class="close-btn" onclick="closeSidebar()">×</span>

        <a href="index.html">الرئيسية</a>
        <a href="about.html">من نحن</a>
        <a href="services.html">الخدمات</a>
        <a href="clients.html">آراء العملاء</a>
        <a href="add-review.html">إضافة تعليق</a>
        <a href="complaints.html">الشكاوي والاقتراحات</a>
        <a href="contact.html">تواصل معنا</a>
        <a href="order.html">طلب خدمة</a>
    </div>

    <header>
        <span class="menu-btn" onclick="openSidebar()">☰</span>
        <img src="logo-new.png.png" alt="شعار سهل للخدمات">
    </header>

    <h1>طلب خدمة</h1>

    <div class="counter" id="ordersCount">عدد الطلبات المنجزة: ...</div>

    <div class="form-box">

        <div id="successBox" class="success-box">
            تم استلام طلبك، سيتم تنفيذه بسرعة البرق
        </div>

        <label>الاسم</label>
        <input type="text" id="name" placeholder="اكتب اسمك">

        <label>رقم الجوال</label>
        <input type="text" id="phone" placeholder="05XXXXXXXX" maxlength="10" oninput="this.value=this.value.replace(/[^0-9]/g,'');">

        <label>تصنيف الخدمة</label>
        <select id="category" onchange="updateDetailsOptions()">
            <option value="">اختر التصنيف</option>
            <option value="خدمات التصميم">خدمات التصميم</option>
            <option value="التعليم والمهام">التعليم والمهام</option>
            <option value="الخدمات الإلكترونية">الخدمات الإلكترونية</option>
        </select>

        <label>تفاصيل الخدمة</label>
        <select id="serviceDetails">
            <option value="">اختر تفاصيل الخدمة</option>
        </select>

        <label>ملاحظة (اختياري – 300 كلمة)</label>
        <textarea id="note" maxlength="300" placeholder="اكتب ملاحظتك هنا..."></textarea>

        <label>كيف عرفت عنا؟</label>
        <select id="know">
            <option value="سناب شات">سناب شات</option>
            <option value="تيك توك">تيك توك</option>
            <option value="إنستغرام">إنستغرام</option>
            <option value="صديق">صديق</option>
            <option value="بحث">بحث</option>
        </select>

        <label>كود الخصم (اختياري)</label>
        <input type="text" id="discount" placeholder="مثال: SAHL10">

        <div class="checkbox-row">
            <input type="checkbox" id="agree1">
            <label for="agree1">أوافق على الشروط والأحكام</label>
        </div>

        <div class="checkbox-row">
            <input type="checkbox" id="agree2">
            <label for="agree2">أقر بأن جميع المعلومات صحيحة</label>
        </div>

        <button onclick="sendOrder()">إرسال الطلب</button>

    </div>

    <footer>
        © <span id="year"></span> سهل للخدمات – جميع الحقوق محفوظة
    </footer>

    <script>
        document.getElementById("year").textContent = new Date().getFullYear();
    </script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBCWMTuFTnCl-XerYIt2uT4Hl_WiyQjEO0",
    authDomain: "sahl-services-94183.firebaseapp.com",
    projectId: "sahl-services-94183",
    storageBucket: "sahl-services-94183.firebasestorage.app",
    messagingSenderId: "926677469615",
    appId: "1:926677469615:web:6ba21a1e73752f5271875a"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.getElementById("orderForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("name").value;
    const phone = document.getElementById("phone").value;
    const category = document.getElementById("category").value;
    const serviceDetails = document.getElementById("serviceDetails").value;
    const note = document.getElementById("note").value;
    const discount = document.getElementById("discount").value;
    const know = document.getElementById("know").value;

    try {
      await addDoc(collection(db, "orders"), {
        name,
        phone,
        category,
        serviceDetails,
        note,
        discount,
        know,
        status: "قيد المراجعة",
        createdAt: serverTimestamp()
      });

      alert("تم إرسال الطلب بنجاح");
      document.getElementById("orderForm").reset();

    } catch (error) {
      alert("حدث خطأ أثناء إرسال الطلب");
      console.log(error);
    }
  });
</script>

</body>
</html>
